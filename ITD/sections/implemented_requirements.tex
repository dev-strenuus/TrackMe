\section{Implemented requirements}

In this section we describe the implemented functionalities with reference to the requirements outlined in the RASD document.\\
The requirements with their reference number green are the ones fully available in the current implementation. 
Requirements in red are not fully implemented but the base for a further complete development is present.

%%
\subsection{Third Party - Registration}
\begin{itemize}
	\item {\color{Green}\textbf{R15)}} Two different users cannot have the same username.
	\item {\color{Green}\textbf{R16)}} The system must allow the third party to register to the application, by specifying its VAT registration number, name and password.
\end{itemize}

\subsubsection*{Database}
The database stores the Third party information and credentials inside the table denominated "THIRD\_PARTY". It also saves the VAT number and password in another table called `USERS` with an attribute that specifies the role of the user (in this case the role is Third party) to determine which requests can be accepted and performed in future.\\

\subsubsection*{Back-end}
The Third party registration implemented API handles the registration process for the Third party and the communication with the database. It performs a check on the presence of an already registered Third party with the same VAT number.

\subsubsection*{Front-end}
The homepage of the client application for a Third party contains a registration section showing a form to fill with registration information. The client application performs simple checks on the lenght and the type of data, sends the request to the server and, if the response is `success`,  shows the login form for the third party.

%%
\subsection{Individual - Registration}
\begin{itemize}
	\item {\color{Green}\textbf{R15)}} Two different users cannot have the same username.
	\item {\color{Green}\textbf{R13)}} The system must allow the individual to register to the application by selecting a password and providing his/her data, fiscal code included;
\end{itemize}

\subsubsection*{Database}
The database stores the Individual information and credentials inside the table denominated 'INDIVIDUAL'. It also saves the VAT number and password in another table called `USERS` with an attribute that specifies the role of the user (in this case the role is Third party) to determine which requests can be accepted and performed in future.\\

\subsubsection*{Back-end} 
The Individual registration implemented API handles the registration process for the individual and the communication with the database. It performs a check on the presence of an already registered Individual with the same fiscal code.

\subsubsection*{Front-end}
The homepage of the client application for an individual contains a registration section showing a form to fill with registration information. The client application performs simple checks on the lenght and the type of data, sends the request to the server and, if the response is `success`,  shows the login form for the individual.

%%
\subsection{Login}
\begin{itemize}
	\item {\color{Green}\textbf{R17)}} The system must allow the third party to log in to the application by providing the combination of a VAT registration number and a password that match an account.
		\item {\color{Green}\textbf{R14)}} The system must allow the individual to log in to the application by providing the combination of a fiscal code and a password that matches an account.
\end{itemize}

\subsubsection*{Back-end}
The Login implemented API manages the login of both Third parties and Individuals by validating the provided credentials and generating a unique access token for the user. 
The access token is generated by taking into account the username and password of the user and the current time.
Every further request to the server must contain this token to be accepted.

\subsubsection*{Front-end}
The front end is the same for Third party and Individual. The application in both cases shows the login form if the user is not logged in.
The client application performs a simple check on the lenght of the data and sends the request to the server. If the response is `success`, the client receives the access token and shows the home page for the Third party or the Individual, otherwise shows an error.

%%
\subsection{Third Party - Settings Management}
\begin{itemize}
	\item {\color{Green}\textbf{R33)}} The system must allow the Third party to change its password.
\end{itemize}
\subsubsection*{Database}
The database updates the data of the Individual by performing an update of the existing tuple.

\subsubsection*{Back-end}
The Modify Third party password implemented API first check if the old password value is really the password of the individual and then communicates to the database the new one. 

\subsubsection*{Front-end}
The client shows a form in which the user can insert the old and the new password. It performs a check on the minimum lenght of the passwords and forwards the data to the back-end, then it shows the response message.

%%
\subsection{Individual - Settings Management}
\begin{itemize}	
	\item {\color{Green}\textbf{R31)}} The system must allow the user to change his/her personal info.
	\item {\color{Green}\textbf{R32)}} The system must allow the individual to change his/her password.
	\item {\color{Red}\textbf{R34)}} The system must allow the user to connect a smartwatch or a similar device to its smartphone.
\end{itemize}
\subsubsection*{Database}
The database updates the data of the Individual by performing an update of the existing tuple. At this point of the implementation only password and location's coordinates can be updated. 

\subsubsection*{Back-end}
The Edit Individual Information implemented API do the proper checks and communicates to the database the new data. It does nothing in order to allow the user to connect a smartwatch or a similar device to its smartphone.

\subsubsection*{Front-end}
The client shows a form in which the user can insert the old and the new password. It performs a check on the minimum lenght of the passwords and forwards the data to the back-end, then it shows the response message. 
The client shows a form in which the user can insert the new personal info, forwards the data to the back-end, then it shows the response message. 
The client shows a button in order to connect the smartphone to the device.


%%
\subsection{Individual - AutomatedSOS service}
\begin{itemize}	
	\item {\color{Green}\textbf{R25)}} The AutomatedSOS service must be enabled.
	\item {\color{Green}\textbf{R18)}} When the health status values go below the threshold, the system must send an SOS within 5 seconds;
	\item {\color{Green}\textbf{R26)}} The system must allow the user to enable/disable the AutomatedSOS service at any time.
\end{itemize}

\subsubsection*{Front-end}
The client gives the user the chance to enable and disable the service by simply pressing a button. If the service is enabled, the application performs a check, every second, on the last N (N equal to 3 in the prototype) received data in order to detect the necessity of help. If all the N data are outside the safety bounds a message is shown and the service is disabled until the Individual reactivates it.
The application must have a connected device sending data to provide the service.

\subsubsection*{Back-end}
The AutomatedSOS implemented API communicates to the database the new preference. 

\subsubsection*{Database}
The database updates the data of the Individual by performing an update of the existing tuple.


%%
\subsection{Individual - Data acquisition}
\begin{itemize}	
	\item {\color{Green}\textbf{R27)}} The system must be able to store data retrieved from registered users.
	\item {\color{Red}\textbf{R3)}} The system must be able to retrieve data from the smartwatches and similar devices;
	\item {\color{Green}\textbf{R35)}} The system must be able to aggregate data based on the location of the individuals residence.\\
\end{itemize}

\subsubsection*{Database}
The database stores the data received by the Individuals in the `INDIVIDUAL\_DATA` table  (mapped with the current residence of the individual) and stores the notifications, containing these data, for third parties subscribed to these data in the `THIRD\_PARTY\_NOTIFICATION` table.

\subsubsection*{Back-end}
The Send data implemented API allows the client to send data to the server and transfer them to the database if they are sent by a registered Individual.
New notifications, containing these data, are created for the third parties who are subscribed to the data of this individual and transfer to the database.

\subsubsection*{Front-end}
The client should retreive data from external devices. It is supposed that data are received every second when a device is connected. The client accumulates data in a list and every time the list reaches size N (N equal to 12 in the prototype) the group of data is sent to the server.
In this first implementation data from external devices are randomly generated when a fictitious device is connected.


%%
\subsection{Data Management}
\begin{itemize}	
	\item {\color{Green}\textbf{R11)}} The system is optimized to send the data received from the mobile application to the third parties as soon as possible.
	\item {\color{Green}\textbf{R9)}} The third party is not allowed to access the users data until he/she accepts the request.
	\item {\color{Green}\textbf{R2)}} The system must be able to provide to the third party the {\color{Red}\textbf{location)}} and the health status of individuals;
	\item {\color{Green}\textbf{R1)}} The users must have given the consensus to the treatment of their information to the third party;
\end{itemize}

\subsubsection*{Database}
The database keeps all the data in the table `INDIVIDUAL\_DATA` and the information of the consensus as a boolean value in `INDIVIDUAL\_REQUEST`.

\subsubsection*{Back-end}
The Get data implemented API allows the third party to request for the data to the server. If it requests for past data, these data are retrieved directly from the table `INDIVIDUAL\_DATA`. Instead if the third party is waiting for new data, the data are retrieved from the table `THIRD\_PARTY\_NOTIFICATION`. The third party controller always checks if the third party has got the rights to retrieve these data.

\subsubsection*{Front-end}
The third party front-end offers a dedicated page for each singular individual request where it shows all his data by asking them to the server as soon as the page is loaded. If the third party is subscribed to new data, every 5 seconds the server is asked for new notifications containing new data.

%%
\subsection{Individual Requests}
\begin{itemize}	
	\item {\color{Green}\textbf{R28)}} The user must have an active subscription to stop it;
	\item {\color{Green}\textbf{R29)}} The system must be able to allow the user to unsubscribe to the third party and to stop the transmission of his/her data.
	\item {\color{Green}\textbf{R7)}} The system must be able to forward the requests from the third party to the user;
	\item {\color{Green}\textbf{R8)}} The system must save the preference of the user;
	\item {\color{Green}\textbf{R37)}} The system must allow the third party to make individual requests.\\
\end{itemize}

\subsubsection*{Database}
The database stores the requests from Third parties to Individuals in the table `INDIVIDUAL\_REQUEST`. A notification for the individual is saved in the table `INDIVIDUAL\_NOTIFICATION`.

\subsubsection*{Back-end}
The Individual Request implemented API allows the third party to make an individual request by communicating with the database. They also allow the individual to retrieve all the individual requests for him and interact with them.

\subsubsection*{Front-end}
The Third party client home page shows a list of the Individuals registered to TrackMe and allows the Third party to make individual request to the servers. The notifications page instead shows all the individual requested made in the past and the response from individuals.
The Individual client notifications page shows all the requests for him and offers him the possibility to accept/refuse/stop the subscription to them by communicating with the Individual Request API.

%%
\subsection{Anonymous Requests}	
\begin{itemize}
	\item {\color{Green}\textbf{R5)}} The system must be able to provide to the third party the health status of individuals
in an anonymous way;
	\item {\color{Green}\textbf{R4)}} The groups must be composed at least by 1000 individuals;
	\item {\color{Green}\textbf{R6)}} The system must be able to aggregate the data of the individuals, as requested by the
third party;
	\item {\color{Green}\textbf{R36)}} The system must allow the third party to make group requests.\\
\end{itemize}
\subsubsection*{Database}
The database stores the requests from Third parties in the table `ANONYMOUS\_REQUEST`.


\subsubsection*{Back-end}
When the Anonymous Request implemented API receive an anonymous request, if it is a well formed request, the server immediately responds to the client. While in the background, the server starts a new thread that, from the timestamp of the first data in DB it will check, until now, with a fixed range of one hour, if there is a group that satisfy the anonymous request.
If the third party, who made the request, subscribed to new data, this operation will be done every hour from so on. If the server crashes, these threads are restarted during the application restart. As soon as data are ready they are inserted in the DB in the table `ANONYMOUS\_ANSWER`.


\subsubsection*{Front-end}
The Third party client home page contains a forms which allow him to create and send to the server an anomymous request.
The Third party client notifications page instead shows all the anonymous requested made in the past. For each singular anonymous request there is a page which shows past and new data concerning that requests and some statistics. Both past and new data are requested every 5 seconds to the server.